{% extends "base.html" %}
{% block title %}Manage Work Gallery{% endblock %}

{% block content %}
<section class="page-card p-4 mb-4">
  <h1 class="section-title mb-1">Manage Work Gallery</h1>
  <p class="section-subtitle mb-0">Upload or remove portfolio images for {{ profile.user.username }}.</p>
</section>

<form method="post" enctype="multipart/form-data" class="form-panel">
  {% csrf_token %}
  {{ formset.management_form }}

  <div class="row g-3">
    {% for form in formset %}
    <div class="col-md-6">
      <div class="page-card p-3 h-100">
        <label class="form-label">Image</label>
        {{ form.image }}
        {% if form.instance.image %}
        <img src="{{ form.instance.image.url }}" alt="Work image" class="w-100 mt-2" style="height:180px;object-fit:cover;border-radius:10px;" loading="lazy" />
        {% endif %}
        {% if form.DELETE %}
        <div class="form-check mt-2">
          {{ form.DELETE }}
          <label class="form-check-label">Remove this image</label>
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="mt-3">
    <button type="submit" class="btn btn-primary">Save Gallery</button>
    <a href="{% url 'profile_detail' profile.user.username %}" class="btn btn-outline-primary ms-2">Back to Profile</a>
  </div>
</form>
{% endblock %}
