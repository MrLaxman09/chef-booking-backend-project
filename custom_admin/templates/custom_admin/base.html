{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin | {% block title %}Dashboard{% endblock %}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link href="{% static 'css/site.css' %}" rel="stylesheet" />
  <style>
    .admin-shell { min-height: 100vh; display: grid; grid-template-columns: 260px 1fr; }
    .admin-sidebar { background: linear-gradient(165deg, #15251a, #1e3324); color: #dce7df; padding: 1.2rem 1rem; }
    .admin-sidebar a { color: #dce7df; text-decoration: none; display: block; padding: .55rem .7rem; border-radius: 10px; margin-bottom: .2rem; font-weight: 600; }
    .admin-sidebar a:hover, .admin-sidebar a.active { background: rgba(255,255,255,.14); color: #fff; }
    .admin-main { padding: 1.2rem; background: #f3f6f1; }
    .admin-topbar { background: #fff; border: 1px solid #d7ded5; border-radius: 14px; padding: .8rem 1rem; margin-bottom: 1rem; }
    @media (max-width: 992px) {
      .admin-shell { grid-template-columns: 1fr; }
      .admin-sidebar { position: sticky; top: 0; z-index: 1020; }
    }
  </style>
  {% block extra_head %}{% endblock %}
</head>
<body>
  <div class="admin-shell">
    <aside class="admin-sidebar">
      <h1 class="h5 text-white mb-3">Admin Dashboard</h1>
      <a href="{% url 'custom_admin:dashboard' %}" class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">Overview</a>
      <a href="{% url 'custom_admin:chef_list' %}" class="{% if request.resolver_match.url_name == 'chef_list' or request.resolver_match.url_name == 'chef_add' or request.resolver_match.url_name == 'chef_edit' %}active{% endif %}">Chefs</a>
      <a href="{% url 'custom_admin:booking_list' %}" class="{% if request.resolver_match.url_name == 'booking_list' or request.resolver_match.url_name == 'booking_view' %}active{% endif %}">Bookings</a>
      <a href="{% url 'custom_admin:blog_list' %}" class="{% if request.resolver_match.url_name == 'blog_list' or request.resolver_match.url_name == 'blog_add' or request.resolver_match.url_name == 'blog_edit' %}active{% endif %}">Blog Posts</a>
      <a href="{% url 'custom_admin:user_list' %}" class="{% if request.resolver_match.url_name == 'user_list' or request.resolver_match.url_name == 'user_view' or request.resolver_match.url_name == 'user_edit' %}active{% endif %}">Users</a>
      <hr class="border-light" />
      <a href="{% url 'home' %}">Back to Site</a>
      <form action="{% url 'custom_admin:logout' %}" method="post" class="mt-2">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-light btn-sm w-100">Sign Out</button>
      </form>
    </aside>

    <main class="admin-main">
      <div class="admin-topbar d-flex justify-content-between align-items-center">
        <div>
          <strong>Signed in as {{ request.user.username }}</strong>
          <div class="text-muted small">Superuser access only</div>
        </div>
      </div>

      {% if messages %}
        {% for m in messages %}
        <div class="alert alert-{{ m.tags }} alert-dismissible fade show" role="alert">
          {{ m }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
      {% endif %}
      {% block content %}{% endblock %}
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
    const deleteModal = document.getElementById('confirmDeleteModal');
    if (deleteModal) {
      deleteModal.addEventListener('show.bs.modal', function (event) {
        const trigger = event.relatedTarget;
        const action = trigger.getAttribute('data-action');
        const name = trigger.getAttribute('data-name');
        const form = deleteModal.querySelector('form');
        const label = deleteModal.querySelector('[data-delete-name]');
        form.setAttribute('action', action);
        label.textContent = name || 'this item';
      });
    }
  </script>
  {% block extra_scripts %}{% endblock %}
</body>
</html>
